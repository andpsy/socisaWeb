@helper GetTreeView(SOCISA.Models.Mesaj[] mesaje, int? parentID, int _indent, int _parentcount)
{
var indent = _indent;
string sIndent = "";
if (indent > 0) {
    sIndent = new string(' ', indent);
}
int index = 0;
foreach (var i in mesaje.Where(a => a.REPLY_TO.Equals(parentID)))
{
        <tr>
            <td>

            </td>
            @{var submenu = mesaje.Where(a => a.REPLY_TO.Equals(i.ID)).Count();}
            @{string bullet = indent == 0 ? "" : index == (_parentcount - 1) ? "└" : "├";}
            <td>
                <a href="#" ng-click="SelectMessage(@i.ID)">@sIndent @bullet @i.SUBIECT</a>
            </td>
            <td>
                @{ var u = (SOCISA.Models.Utilizator)i.GetSender().Result;}
                @u.NUME_COMPLET ( @u.EMAIL )
            </td>
            <td>
                @i.DATA.ToString("dd.MM.yyyy HH:mm:ss")
            </td>
        </tr>
        if (submenu > 0)
        {
            @TreeView.GetTreeView(mesaje, Convert.ToInt32(i.ID), ++indent, submenu)
        }
        ++index;
    }
}
